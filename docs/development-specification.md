# Tech Shelf é–‹ç™ºæŒ‡ç¤ºæ›¸

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Tech Shelfã¯ã€æŠ€è¡“ãƒ–ãƒ­ã‚°ã®åŸ·ç­†ã‹ã‚‰é›»å­æ›¸ç±ã®å‡ºç‰ˆã¾ã§ã‚’ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«è¡Œãˆã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚SvelteKitã‚’ä½¿ç”¨ã—ã¦ã€ãƒ–ãƒ­ã‚°æ©Ÿèƒ½ã¨é›»å­æ›¸ç±ã®ä½œæˆãƒ»é–²è¦§ãƒ»è²©å£²æ©Ÿèƒ½ã‚’æŒã¤Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã—ã¾ã™ã€‚

### ä¸»è¦æ©Ÿèƒ½

- ãƒ–ãƒ­ã‚°è¨˜äº‹ã®æŠ•ç¨¿ãƒ»ç®¡ç†ï¼ˆä¼šå“¡é™å®šï¼‰
- ãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’é›†ç´„ã—ãŸé›»å­æ›¸ç±ä½œæˆ
- AIã«ã‚ˆã‚‹é›»å­æ›¸ç±ã®è‡ªå‹•ç”Ÿæˆ
- Markdownã‚¨ãƒ‡ã‚£ã‚¿ã¨éšå±¤æ§‹é€ ç®¡ç†
- é›»å­æ›¸ç±ã®è²©å£²ãƒ»è³¼å…¥

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: SvelteKit v2, Svelte 5, TypeScript 5.0+
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: Tailwind CSS v4 + Skeleton UI v3
- **ã‚¨ãƒ‡ã‚£ã‚¿**: CodeMirror 6 / Monaco Editor
- **Markdownå‡¦ç†**: marked / remark / MDsveX
- **æ•°å¼**: KaTeX / MathJax
- **ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ **: Mermaid
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Supabase (æœ¬ç•ª) + SQLite (ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º)
- **ORM**: Prisma (SQLite/PostgreSQLä¸¡å¯¾å¿œ)
- **èªè¨¼**: Supabase Auth (ãƒãƒ«ãƒãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å¯¾å¿œ)
- **AI**: OpenAI API / Claude API
- **æ¤œç´¢**: MeiliSearch (ãƒ­ãƒ¼ã‚«ãƒ«ãƒ»æœ¬ç•ªå…±é€š)
- **æ±ºæ¸ˆ**: Stripe (TypeScript SDK)
- **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: Supabase Storage (æœ¬ç•ª) + ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ« (é–‹ç™º)
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: Vercel ã¾ãŸã¯ Netlify
- **é›»å­æ›¸ç±**: epub.js, PDF.js

## ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³ (2025å¹´7æœˆ12æ—¥æ›´æ–°)

### å®Œäº†æ¸ˆã¿

- âœ… åŸºæœ¬çš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®æ§‹ç¯‰
- âœ… Tailwind CSS v4 + Skeleton UI v3ã®çµ±åˆ
- âœ… Prismaã‚¹ã‚­ãƒ¼ãƒã®è¨­è¨ˆï¼ˆUser, Book, Chapter, Purchase, ReadingSession, Bookmark, BlogPost, Tagï¼‰
- âœ… ãƒ–ãƒ­ã‚°æ©Ÿèƒ½ã®åŸºæœ¬å®Ÿè£…ï¼ˆä¸€è¦§ã€è©³ç´°ã€ã‚¿ã‚°ã€RSS/Atomé…ä¿¡ï¼‰
- âœ… ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®å®Ÿè£…
- âœ… åŸºæœ¬çš„ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… æ›¸ç±ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆ/booksï¼‰ã®å®Ÿè£…
- âœ… æ›¸ç±è©³ç´°ãƒšãƒ¼ã‚¸ï¼ˆ/books/[id]ï¼‰ã®å®Ÿè£…
- âœ… æ›¸ç±ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã¨ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯
- âœ… ãƒ†ã‚¹ãƒˆç”¨ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ï¼ˆ5å†Šã®æ›¸ç±ï¼‰
- âœ… é›»å­æ›¸ç±ãƒªãƒ¼ãƒ€ãƒ¼æ©Ÿèƒ½ï¼ˆ/reader/[bookId]/[chapterId]ï¼‰
  - âœ… ãƒªãƒ¼ãƒ€ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆWebReader, TableOfContents, ReadingProgress, ReaderControlsï¼‰
  - âœ… ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºèª¿æ•´ãƒ»ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
  - âœ… ç« ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ç›®æ¬¡è¡¨ç¤º
  - âœ… èª­æ›¸é€²æ—è¡¨ç¤ºï¼ˆç¾åœ¨ã®ç« /å…¨ç« æ•°ï¼‰
- âœ… èªè¨¼æ©Ÿèƒ½ï¼ˆé–‹ç™ºç’°å¢ƒç”¨ãƒ¢ãƒƒã‚¯èªè¨¼ï¼‰
  - âœ… ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ç™»éŒ²ãƒšãƒ¼ã‚¸ã®å®Ÿè£…ï¼ˆ/login, /registerï¼‰
  - âœ… ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã®å®Ÿè£…ï¼ˆ/profileï¼‰
  - âœ… ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½ï¼ˆ/logoutï¼‰
  - âœ… Cookieèªè¨¼ã«ã‚ˆã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
  - âœ… èªè¨¼çŠ¶æ…‹ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ç®¡ç†ï¼ˆauth storeï¼‰
- âœ… ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ•´å‚™
  - âœ… è©³ç´°ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ï¼ˆdocs/setup-guide.mdï¼‰
  - âœ… README.mdã®æ›´æ–°ï¼ˆNode.js 22ä»¥ä¸Šå¯¾å¿œï¼‰
- âœ… ãƒ–ãƒ­ã‚°æŠ•ç¨¿æ©Ÿèƒ½ï¼ˆPhase 3ï¼‰
  - âœ… Markdownã‚¨ãƒ‡ã‚£ã‚¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆCodeMirror 6çµ±åˆï¼‰
  - âœ… ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒšã‚¤ãƒ³ï¼ˆéšå±¤æ§‹é€ è¡¨ç¤ºï¼‰
  - âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆ2ãƒšã‚¤ãƒ³è¡¨ç¤ºï¼‰
  - âœ… è¨˜äº‹æŠ•ç¨¿ãƒšãƒ¼ã‚¸ï¼ˆ/blog/createï¼‰
  - âœ… è¨˜äº‹ä¿å­˜APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
  - âœ… ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã«ã€Œæ–°è¦ä½œæˆã€ãƒœã‚¿ãƒ³è¿½åŠ 
  - âœ… ä½œè€…æœ¬äººã¯ä¸‹æ›¸ãè¨˜äº‹ã‚‚é–²è¦§å¯èƒ½
- âœ… PrismaClientã®ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹çµ±ä¸€
  - âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼ã®è§£æ±º
  - âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®å‘ä¸Š
- âœ… ãƒ–ãƒ­ã‚°ç·¨é›†æ©Ÿèƒ½
  - âœ… ç·¨é›†ãƒšãƒ¼ã‚¸ã®ä½œæˆï¼ˆ/blog/edit/[id]ï¼‰
  - âœ… æ—¢å­˜è¨˜äº‹ã®ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ 
  - âœ… å…¬é–‹/ä¸‹æ›¸ãçŠ¶æ…‹ã®åˆ‡ã‚Šæ›¿ãˆ
  - âœ… ç·¨é›†æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼ˆä½œè€…æœ¬äººã®ã¿ï¼‰
  - âœ… ãƒ–ãƒ­ã‚°è©³ç´°ãƒšãƒ¼ã‚¸ã«ç·¨é›†ãƒœã‚¿ãƒ³è¿½åŠ 
- âœ… ãƒã‚¤ãƒ–ãƒ­ã‚°ãƒšãƒ¼ã‚¸ï¼ˆ/blog/myï¼‰
  - âœ… è‡ªåˆ†ã®è¨˜äº‹ä¸€è¦§è¡¨ç¤º
  - âœ… ä¸‹æ›¸ããƒ»å…¬é–‹æ¸ˆã¿ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
  - âœ… ç·¨é›†ãƒœã‚¿ãƒ³ã®è¡¨ç¤º
  - âœ… ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã«ãƒªãƒ³ã‚¯è¿½åŠ 

### å®Ÿè£…ä¸­/èª²é¡Œ

- ğŸ”„ Supabaseèªè¨¼ã¸ã®ç§»è¡Œæº–å‚™
  - ç¾åœ¨ã¯ãƒ¢ãƒƒã‚¯èªè¨¼ï¼ˆé–‹ç™ºç’°å¢ƒç”¨ï¼‰ã‚’ä½¿ç”¨
  - æœ¬ç•ªç’°å¢ƒã§ã¯Supabase Authã¸ã®åˆ‡ã‚Šæ›¿ãˆãŒå¿…è¦
- ğŸ”„ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã¨Prismaãƒ¢ãƒ‡ãƒ«ã®é€£æº
  - ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®test@example.comãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®çµ±åˆ

### æœªå®Ÿè£…

- âŒ æœ¬ç•ªç”¨èªè¨¼æ©Ÿèƒ½ï¼ˆSupabase Authçµ±åˆï¼‰
- âŒ ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- âŒ ã‚¿ã‚°ãƒ»ã‚«ãƒ†ã‚´ãƒªç®¡ç†æ©Ÿèƒ½ã®å¼·åŒ–
- âŒ äºˆç´„æŠ•ç¨¿æ©Ÿèƒ½
- âŒ ã‚·ãƒªãƒ¼ã‚ºç®¡ç†æ©Ÿèƒ½
- âŒ é›»å­æ›¸ç±ä½œæˆæ©Ÿèƒ½ï¼ˆãƒ–ãƒ­ã‚°è¨˜äº‹ã‹ã‚‰ã®æ›¸ç±åŒ–ï¼‰
- âŒ AIæ›¸ç±ç”Ÿæˆæ©Ÿèƒ½ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒ»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è‡ªå‹•ç”Ÿæˆï¼‰
- âŒ è³¼å…¥ãƒ»æ±ºæ¸ˆæ©Ÿèƒ½ï¼ˆStripeï¼‰
- âŒ ç®¡ç†ç”»é¢
- âŒ æ¤œç´¢æ©Ÿèƒ½ï¼ˆMeiliSearchï¼‰
- âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆè³¼å…¥æ¸ˆã¿æ›¸ç±ã®ç®¡ç†ï¼‰
- âŒ èª­æ›¸é€²æ—ã®æ°¸ç¶šåŒ–ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜ï¼‰
- âŒ ã—ãŠã‚Šãƒ»ãƒã‚¤ãƒ©ã‚¤ãƒˆæ©Ÿèƒ½
- âŒ epub.js / PDF.js çµ±åˆ

## ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢è¨­è¨ˆ

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ

```bash
# SQLite + Prisma ã§é«˜é€Ÿé–‹ç™º
npm run dev:setup  # SQLiteãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
npm run db:migrate # ã‚¹ã‚­ãƒ¼ãƒé©ç”¨
npm run db:seed    # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŠ•å…¥
npm run dev        # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
```

### æœ¬ç•ªç’°å¢ƒ

```bash
# Supabase PostgreSQL
npm run deploy:staging  # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ
npm run deploy:prod     # æœ¬ç•ªç’°å¢ƒ
```

### ç’°å¢ƒåˆ¥è¨­å®š

```typescript
// src/lib/config/database.ts
export const dbConfig = {
  development: {
    provider: 'sqlite',
    url: 'file:./dev.db',
  },
  staging: {
    provider: 'postgresql',
    url: process.env.SUPABASE_DATABASE_URL,
  },
  production: {
    provider: 'postgresql',
    url: process.env.SUPABASE_DATABASE_URL,
  },
};
```

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
project-root/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ (app)/              # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒª
â”‚   â”‚   â”‚   â”œâ”€â”€ blog/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ +page.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ [slug]/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ create/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ +page.svelte
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ +page.server.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ edit/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ [id]/
â”‚   â”‚   â”‚   â”œâ”€â”€ books/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ +page.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ [id]/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ create/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ +page.svelte
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ +page.server.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ edit/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ [id]/
â”‚   â”‚   â”‚   â”œâ”€â”€ reader/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [bookId]/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ +page.svelte
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ +page.server.ts
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ [chapterId]/
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ +page.svelte
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ +page.server.ts
â”‚   â”‚   â”‚   â””â”€â”€ profile/
â”‚   â”‚   â”œâ”€â”€ (auth)/             # èªè¨¼é–¢é€£
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”œâ”€â”€ register/
â”‚   â”‚   â”‚   â””â”€â”€ callback/
â”‚   â”‚   â”œâ”€â”€ (admin)/            # ç®¡ç†ç”»é¢
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”œâ”€â”€ books/
â”‚   â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â””â”€â”€ analytics/
â”‚   â”‚   â”œâ”€â”€ api/                # API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ books/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ payments/
â”‚   â”‚   â”‚   â””â”€â”€ search/
â”‚   â”‚   â”œâ”€â”€ +layout.svelte
â”‚   â”‚   â””â”€â”€ +page.svelte
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/             # åŸºæœ¬UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Button.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Modal.svelte
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Card.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.svelte
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ blog/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BlogList.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BlogPost.svelte
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BlogCard.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ books/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BookList.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BookDetail.svelte
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BookCard.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ reader/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WebReader.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TableOfContents.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ReadingProgress.svelte
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ReaderControls.svelte
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BookmarkPanel.svelte
â”‚   â”‚   â”‚   â””â”€â”€ editor/
â”‚   â”‚   â”‚       â”œâ”€â”€ MarkdownEditor.svelte
â”‚   â”‚   â”‚       â”œâ”€â”€ OutlinePane.svelte
â”‚   â”‚   â”‚       â”œâ”€â”€ PreviewPane.svelte
â”‚   â”‚   â”‚       â””â”€â”€ EditorToolbar.svelte
â”‚   â”‚   â”œâ”€â”€ stores/             # Svelte stores
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ books.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ reading.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ editor.ts
â”‚   â”‚   â”‚   â””â”€â”€ ui.ts
â”‚   â”‚   â”œâ”€â”€ server/             # ã‚µãƒ¼ãƒãƒ¼å´ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ database.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ books.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ chapters.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ reading.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ blog.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ ai.ts
â”‚   â”‚   â”‚   â””â”€â”€ payments.ts
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ helpers.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ constants.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ markdown.ts
â”‚   â”‚   â”‚   â””â”€â”€ outline.ts
â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â”œâ”€â”€ book.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ user.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ reading.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ blog.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ editor.ts
â”‚   â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”‚   â””â”€â”€ config/
â”‚   â”‚       â”œâ”€â”€ database.ts
â”‚   â”‚       â”œâ”€â”€ auth.ts
â”‚   â”‚       â””â”€â”€ environment.ts
â”‚   â””â”€â”€ app.html
â”œâ”€â”€ content/                    # é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
â”‚   â”œâ”€â”€ blog/
â”‚   â”œâ”€â”€ books/
â”‚   â”‚   â””â”€â”€ rust-guide/
â”‚   â””â”€â”€ assets/
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma
â”‚   â”œâ”€â”€ migrations/
â”‚   â””â”€â”€ seed.ts
â”œâ”€â”€ static/
â”œâ”€â”€ tests/
â”œâ”€â”€ docs/
â”œâ”€â”€ package.json
â”œâ”€â”€ svelte.config.js
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ tsconfig.json
â””â”€â”€ .env.example
```

## é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚º

### Phase 1: åŸºç›¤æ§‹ç¯‰ (2é€±é–“) âœ… å®Œäº†

- SvelteKitãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
- TypeScript + Tailwind CSSè¨­å®š
- Prisma ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ
- ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ï¼ˆSQLiteï¼‰
- åŸºæœ¬èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆSupabase Authï¼‰

### Phase 2: èªè¨¼ãƒ»ä¼šå“¡æ©Ÿèƒ½ (2é€±é–“) âœ… åŸºæœ¬å®Ÿè£…å®Œäº†

- âœ… ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆãƒ¢ãƒƒã‚¯èªè¨¼ã§å®Ÿè£…æ¸ˆã¿ï¼‰
- âœ… ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç®¡ç†ãƒšãƒ¼ã‚¸
- âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆCookieèªè¨¼ï¼‰
- ğŸ”„ Supabase Authçµ±åˆï¼ˆæœ¬ç•ªç’°å¢ƒå‘ã‘ï¼‰
- âŒ æ¨©é™ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨å®Ÿè£…

### Phase 3: ãƒ–ãƒ­ã‚°æŠ•ç¨¿æ©Ÿèƒ½ (3é€±é–“) âœ… åŸºæœ¬å®Ÿè£…å®Œäº†

- âœ… Markdownã‚¨ãƒ‡ã‚£ã‚¿å®Ÿè£…
  - âœ… CodeMirror 6çµ±åˆ
  - âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
  - âœ… éšå±¤æ§‹é€ è¡¨ç¤ºï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒšã‚¤ãƒ³ï¼‰
- âœ… è¨˜äº‹æŠ•ç¨¿æ©Ÿèƒ½
- âŒ è¨˜äº‹ç·¨é›†æ©Ÿèƒ½
- âŒ ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ï¼‰
- âŒ ä¸‹æ›¸ããƒ»äºˆç´„æŠ•ç¨¿
- âŒ ã‚·ãƒªãƒ¼ã‚ºç®¡ç†
- âœ… åŸºæœ¬çš„ãªã‚¿ã‚°ç®¡ç†

### Phase 4: é›»å­æ›¸ç±ä½œæˆæ©Ÿèƒ½ (4é€±é–“)

- æ›¸ç±ä½œæˆã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰
- ãƒ–ãƒ­ã‚°è¨˜äº‹é¸æŠUI
- AIç« æ§‹æˆææ¡ˆ
- çµ±åˆã‚¨ãƒ‡ã‚£ã‚¿å®Ÿè£…
  - éšå±¤æ§‹é€ ç®¡ç†
  - ç« ã®ä¸¦ã³æ›¿ãˆãƒ»åˆ†å‰²ãƒ»çµåˆ
- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ï¼ˆPDF/ePubï¼‰

### Phase 5: AIæ›¸ç±ç”Ÿæˆæ©Ÿèƒ½ (3é€±é–“)

- OpenAI/Claude APIçµ±åˆ
- ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³è‡ªå‹•ç”Ÿæˆ
- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆæ©Ÿèƒ½
- ç”Ÿæˆç®¡ç†UI
- ç·¨é›†ãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½

### Phase 6: æ±ºæ¸ˆãƒ»è²©å£²æ©Ÿèƒ½ (3é€±é–“)

- Stripeçµ±åˆ
- è³¼å…¥ãƒ•ãƒ­ãƒ¼å®Ÿè£…
- ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½
- å£²ä¸Šç®¡ç†ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- æŒ¯è¾¼å‡¦ç†
- é ˜åæ›¸ç™ºè¡Œ

### Phase 7: æœ€é©åŒ–ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ (1é€±é–“)

- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- Supabaseæœ¬ç•ªç’°å¢ƒç§»è¡Œ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–
- æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤

## é‡è¦ãªå®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ

### 1. TypeScriptå‹å®šç¾©

```typescript
// src/lib/types/book.ts
export interface Book {
  id: string;
  title: string;
  author: string;
  description: string;
  coverImage: string;
  price: number;
  currency: 'JPY' | 'USD' | 'EUR';
  language: string;
  publishedAt: Date;
  createdAt: Date;
  updatedAt: Date;
  chapters: Chapter[];
  metadata: BookMetadata;
  tags: string[];
  category: BookCategory;
  difficulty: DifficultyLevel;
  isPublished: boolean;
  authorId: string;
  sourceType: 'manual' | 'blog_posts' | 'ai_generated';
}

export interface Chapter {
  id: string;
  bookId: string;
  title: string;
  content: string;
  order: number;
  wordCount: number;
  estimatedReadingTime: number;
  partNumber: number;
  slug: string;
  sourcePostId?: string; // ãƒ–ãƒ­ã‚°è¨˜äº‹ã‹ã‚‰ä½œæˆã•ã‚ŒãŸå ´åˆ
}

// src/lib/types/blog.ts
export interface BlogPost {
  id: string;
  slug: string;
  title: string;
  content: string; // Markdown
  excerpt?: string;
  coverImage?: string;
  published: boolean;
  publishedAt?: Date;
  views: number;
  likes: number;
  estimatedReadingTime: number;
  authorId: string;
  author: User;
  tags: string[];
  seriesId?: string;
  seriesOrder?: number;
  createdAt: Date;
  updatedAt: Date;
}

export interface BlogSeries {
  id: string;
  title: string;
  description?: string;
  slug: string;
  authorId: string;
  posts: BlogPost[];
}

// src/lib/types/editor.ts
export interface EditorState {
  content: string;
  outline: Outline[];
  isDirty: boolean;
  autoSaveEnabled: boolean;
  lastSaved?: Date;
}

export interface Outline {
  id: string;
  level: number; // 1-6 (H1-H6)
  text: string;
  line: number;
  children?: Outline[];
}

// src/lib/types/user.ts
export interface User {
  id: string;
  email: string;
  name: string;
  avatar?: string;
  role: 'reader' | 'author' | 'admin';
  providers: AuthProvider[];
  purchasedBooks: string[];
  createdAt: Date;
  updatedAt: Date;
}

export interface AuthProvider {
  provider: 'google' | 'github' | 'email';
  providerId: string;
  email: string;
}

export interface ReadingSession {
  id: string;
  userId: string;
  bookId: string;
  chapterId: string;
  position: number;
  percentage: number;
  lastReadAt: Date;
  device: string;
}
```

### 2. Prisma ã‚¹ã‚­ãƒ¼ãƒ

```prisma
// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = env("DATABASE_PROVIDER") // "sqlite" | "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String            @id @default(cuid())
  email           String            @unique
  name            String
  avatar          String?
  role            String            @default("reader") // "reader" | "author" | "admin"
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt

  // Relations
  purchasedBooks  Purchase[]
  readingSessions ReadingSession[]
  bookmarks       Bookmark[]
  authoredBooks   Book[]           @relation("BookAuthor")
  blogPosts       BlogPost[]
  blogSeries      BlogSeries[]

  @@map("users")
}

model Book {
  id          String    @id @default(cuid())
  title       String
  author      String
  description String
  coverImage  String?
  price       Float
  currency    String    @default("JPY")
  language    String    @default("ja")
  category    String    @default("other")
  difficulty  String    @default("intermediate")
  isPublished Boolean   @default(false)
  publishedAt DateTime?

  // Book creation source
  sourceType  String    @default("manual") // "manual" | "blog_posts" | "ai_generated"

  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  // Relations
  authorId    String
  authorUser  User              @relation("BookAuthor", fields: [authorId], references: [id])
  chapters    Chapter[]
  purchases   Purchase[]
  sessions    ReadingSession[]
  bookmarks   Bookmark[]
  tags        BookTag[]
  bookProject BookCreationProject?

  @@map("books")
}

model Chapter {
  id            String    @id @default(cuid())
  bookId        String
  title         String
  slug          String
  content       String    // Markdown/HTML content
  order         Int
  wordCount     Int       @default(0)
  estimatedReadingTime Int @default(0)
  partNumber    Int       @default(1)

  // Source tracking
  sourcePostId  String?   // If created from blog post

  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  // Relations
  book          Book      @relation(fields: [bookId], references: [id])
  sourcePost    BlogPost? @relation("ChapterSource", fields: [sourcePostId], references: [id])

  @@unique([bookId, slug])
  @@map("chapters")
}

model BlogPost {
  id            String         @id @default(cuid())
  slug          String         @unique
  title         String
  content       String         // Markdown content
  excerpt       String?
  coverImage    String?
  published     Boolean        @default(false)
  publishedAt   DateTime?
  views         Int            @default(0)
  likes         Int            @default(0)
  estimatedReadingTime Int     @default(0)

  // Series
  seriesId      String?
  series        BlogSeries?    @relation(fields: [seriesId], references: [id])
  seriesOrder   Int?

  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt

  // Relations
  authorId      String
  author        User           @relation(fields: [authorId], references: [id])
  tags          BlogPostTag[]
  bookChapters  Chapter[]      @relation("ChapterSource")
  bookProjects  BookProjectPost[]

  @@map("blog_posts")
}

model BlogSeries {
  id          String      @id @default(cuid())
  title       String
  description String?
  slug        String      @unique

  // Relations
  authorId    String
  author      User        @relation(fields: [authorId], references: [id])
  posts       BlogPost[]

  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  @@map("blog_series")
}

model BookCreationProject {
  id          String    @id @default(cuid())
  name        String
  status      String    @default("draft") // "draft" | "generating" | "editing" | "completed"

  // AI generation settings
  aiModel     String?   // "gpt-4" | "claude-3"
  prompt      String?
  outline     Json?     // AI generated outline

  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  // Relations
  bookId      String    @unique
  book        Book      @relation(fields: [bookId], references: [id])
  selectedPosts BookProjectPost[]

  @@map("book_creation_projects")
}

model BookProjectPost {
  id          String    @id @default(cuid())
  order       Int       // Order in the book

  // Relations
  projectId   String
  project     BookCreationProject @relation(fields: [projectId], references: [id])
  postId      String
  post        BlogPost  @relation(fields: [postId], references: [id])

  @@unique([projectId, postId])
  @@map("book_project_posts")
}

// ... ãã®ä»–ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆPurchase, ReadingSession, Bookmark, Tagé–¢é€£ï¼‰ã¯æ—¢å­˜ã®ã¾ã¾
```

### 3. Svelte Stores

```typescript
// src/lib/stores/auth.ts
import { writable } from 'svelte/store';
import type { User } from '$lib/types/user';

interface AuthState {
  user: User | null;
  loading: boolean;
  error: string | null;
}

const createAuthStore = () => {
  const { subscribe, set, update } = writable<AuthState>({
    user: null,
    loading: true,
    error: null,
  });

  return {
    subscribe,
    login: async (provider: 'google' | 'github' | 'email', credentials?: any) => {
      // Supabase Authå®Ÿè£…
    },
    logout: async () => {
      // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†
    },
    refresh: async () => {
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³æ›´æ–°
    },
  };
};

export const auth = createAuthStore();

// src/lib/stores/editor.ts
import { writable } from 'svelte/store';
import type { EditorState, Outline } from '$lib/types/editor';

const createEditorStore = () => {
  const { subscribe, set, update } = writable<EditorState>({
    content: '',
    outline: [],
    isDirty: false,
    autoSaveEnabled: true,
  });

  return {
    subscribe,
    updateContent: (content: string) => {
      update((state) => ({ ...state, content, isDirty: true }));
    },
    updateOutline: (outline: Outline[]) => {
      update((state) => ({ ...state, outline }));
    },
    save: async () => {
      // ä¿å­˜å‡¦ç†
    },
  };
};

export const editor = createEditorStore();
```

### 4. Markdownã‚¨ãƒ‡ã‚£ã‚¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```svelte
<!-- src/lib/components/editor/MarkdownEditor.svelte -->
<script lang="ts">
  import { onMount } from 'svelte';
  import { editor } from '$lib/stores/editor';
  import type { EditorView } from '@codemirror/view';
  import { markdown } from '@codemirror/lang-markdown';

  export let value: string = '';
  export let placeholder: string = 'Start writing...';

  let editorElement: HTMLDivElement;
  let view: EditorView;

  onMount(() => {
    // CodeMirror 6 åˆæœŸåŒ–
    initializeEditor();

    return () => {
      view?.destroy();
    };
  });

  const initializeEditor = async () => {
    const { EditorView, basicSetup } = await import('@codemirror/basic-setup');
    const { EditorState } = await import('@codemirror/state');

    view = new EditorView({
      state: EditorState.create({
        doc: value,
        extensions: [
          basicSetup,
          markdown(),
          // ã‚«ã‚¹ã‚¿ãƒ æ‹¡å¼µ
        ],
      }),
      parent: editorElement,
    });
  };
</script>

<div class="editor-container">
  <div bind:this={editorElement} class="editor"></div>
</div>

<style>
  .editor-container {
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .editor {
    flex: 1;
    overflow: auto;
  }
</style>
```

## ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºä½“é¨“ã®å‘ä¸Š

### é–‹ç™ºç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```json
// package.json
{
  "scripts": {
    "dev": "vite dev",
    "dev:setup": "npm run db:setup && npm run dev",
    "db:setup": "prisma migrate dev && prisma db seed",
    "db:migrate": "prisma migrate dev",
    "db:seed": "prisma db seed",
    "db:reset": "prisma migrate reset --force",
    "build": "vite build",
    "preview": "vite preview",
    "check": "svelte-kit sync && svelte-check --tsconfig ./tsconfig.json",
    "check:watch": "svelte-kit sync && svelte-check --tsconfig ./tsconfig.json --watch",
    "test": "vitest",
    "test:ui": "vitest --ui",
    "lint": "prettier --check . && eslint .",
    "format": "prettier --write ."
  }
}
```

### ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```bash
# .env.example
# Database
DATABASE_PROVIDER=sqlite
DATABASE_URL=file:./dev.db

# Supabase
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_KEY=your_supabase_service_key

# Stripe
STRIPE_PUBLIC_KEY=pk_test_...
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# MeiliSearch
MEILISEARCH_HOST=http://localhost:7700
MEILISEARCH_API_KEY=your_meilisearch_key

# AI APIs
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...

# Authentication
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret

# Application
PUBLIC_APP_URL=http://localhost:5173
NODE_ENV=development
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

1. **èªè¨¼ãƒ»èªå¯**
   - Supabase Row Level Security (RLS)
   - APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä¿è­·
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
   - å½¹å‰²ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆRBACï¼‰

2. **ãƒ‡ãƒ¼ã‚¿ä¿è­·**
   - å€‹äººæƒ…å ±ã®æš—å·åŒ–
   - HTTPSã®å¼·åˆ¶
   - CSRFãƒˆãƒ¼ã‚¯ãƒ³
   - XSSå¯¾ç­–ï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚µãƒ‹ã‚¿ã‚¤ã‚ºï¼‰

3. **æ±ºæ¸ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
   - Stripe PCIæº–æ‹ 
   - Webhookã®æ¤œè¨¼
   - æ±ºæ¸ˆæƒ…å ±ã®éä¿å­˜

4. **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¿è­·**
   - é›»å­æ›¸ç±ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰åˆ¶é™
   - AIç”Ÿæˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ç®¡ç†
